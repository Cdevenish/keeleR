---
title: "Comparing between groups"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
knitr::opts_chunk$set(echo = FALSE)
```


# Comparing between groups  

## Example workflow

*Here's an example analysis where we want to compare between two groups.*

Run the R code to follow the story.

You are studying the rare, threatened Tee bird in South America. As part of some basic ecological analysis you want to know whether there is a difference in weight between sexes as this might inform different conservation strategies. You have a data set of some female and male weights from captured birds.

We are going to use the analysis protocol to work through this example.

-*1 Ask your question*
Is there a difference in weight between female and male Tee birds?
(i.e. comparing mean weight between two groups)

-2 *Check and explore your data*

-2.1 First import the data. 

```{r example-t-test-import, exercise=TRUE}

tBird <- read.csv("./inData/bird_captures.csv", stringsAsFactors = TRUE)

```

-2.2 Now explore the data. 
How many columns are there? What do they represent? Remember the `head()` and `str()` functions?

```{r example-t-test-explore, exercise=TRUE, exercise.setup = "example-t-test-import"}
head(tBird)
str(tBird) # Numeric and categorical (factor) data types

```

-2.3 Now plot the data

```{r example-t-test-plot1, exercise=TRUE, exercise.setup = "example-t-test-import"}
# Index plots - any obvious outliers?
plot(tBird$weight)

```

A box plot is suitable for a numeric variable and a categorical (grouping) variable.

```{r example-t-test-plot2, exercise=TRUE, exercise.setup = "example-t-test-import"}

boxplot(weight ~ sex, data = tBird)

```

-3 *Write your Null Hypothesis - H0*

There is no difference between the mean weight of female and male Tee birds from a sample of 30 captures.

-4 *Decide on your stats test*

We have two groups (two levels of the sex factor) and a numeric (response) variable. To find whether there is a significant difference between groups could be assessed with a T-test or a Wilcoxon Test.

-4.1 Is our data normal? Check distribution visually.
```{r example-t-test-decide-hist, exercise=TRUE, exercise.setup = "example-t-test-import"}

tapply(tBird$weight, tBird$sex, hist)

```

This can also be tested formally, but let's go by the histograms and assume they are normally distributed.

-5 *Do test and check significance value*
```{r example-t-test-doTest, exercise=TRUE, exercise.setup = "example-t-test-import"}
# Given that our data are normally distributed, we can use the t-test:
t.test(weight ~ sex, data = tBird) # note this is the same format as the boxplot

```


-6 *Present your results*

-6.1 Extract statistics, effect size, sample size.
```{r example-t-test-stats, exercise=TRUE, exercise.setup = "example-t-test-import"}
# For simple tests like this you can copy directly from the console (it's also possible to export as a csv)
# i.e. Copy the p-value, t statistic and the degrees of freedom (an indication of sample size)
t.test(weight ~ sex, data = tBird)

# We also want to report the means, and standard deviations for each group
tapply(tBird$weight, tBird$sex, mean)
tapply(tBird$weight, tBird$sex, sd)

```

-6.2  Make a plot the data for your report

Do a plot with all the correct axis labels (including units), axis limits, etc.
```{r example-t-test-plot, exercise=TRUE, exercise.setup = "example-t-test-import"}

boxplot(weight ~ sex, data = tBird,
        xlab = "Weight (g)",
        ylab = "Sex",
        main = "")

```

6.3 Write a results statement:

Using a t-test we found that, on average, female Tee birds were significantly heavier than males (t = 3.71, df = 57.9, p < 0.001) from a sample of 30 captures. Females had a higher mean weight (8.14g `r knitr::asis_output("\U00B1")`0.70) than males (7.45g `r knitr::asis_output("\U00B1")` 0.74).

 
